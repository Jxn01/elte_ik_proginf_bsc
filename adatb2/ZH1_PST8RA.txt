-- 1. FELADAT
SELECT OWNER, TABLE_NAME FROM(
SELECT OWNER, TABLE_NAME, COUNT(DISTINCT SYNONYM_NAME) SUM FROM DBA_SYNONYMS
GROUP BY OWNER, TABLE_NAME
ORDER BY SUM DESC
FETCH FIRST 1 ROWS ONLY);

-- OWNER | TABLE_NAME
-- ------------------
-- VDANI | DOLGOZO

-- 2. FELADAT
SELECT SEGMENT_NAME FROM(
SELECT SEGMENT_NAME, SUM(BLOCKS) SUM FROM DBA_EXTENTS
WHERE OWNER = 'VDANI' AND SEGMENT_TYPE = 'TABLE'
GROUP BY SEGMENT_NAME
ORDER BY SUM DESC
FETCH FIRST 1 ROWS ONLY);

-- SEGMENT_NAME
-- ------------
-- TAR_TESZT

-- 3. FELADAT
-- SKIP

-- 4. FELADAT
CREATE OR REPLACE FUNCTION foglalt(D1 DATE, D2 DATE) RETURN INTEGER IS
    RESULT INTEGER;
    BEGIN
    SELECT SUM(BYTES)/1024 INTO RESULT FROM DBA_EXTENTS
    WHERE OWNER IN
        (SELECT OWNER FROM DBA_OBJECTS
        WHERE OBJECT_TYPE = 'TABLE'
        AND CREATED BETWEEN D1 AND D2)
    AND SEGMENT_NAME IN
        (SELECT OBJECT_NAME FROM DBA_OBJECTS
        WHERE OBJECT_TYPE = 'TABLE'
        AND CREATED BETWEEN D1 AND D2);
    RETURN RESULT;
END;
/

select foglalt(to_date('2023.09.16', 'YYYY.MM.DD'), to_date('2023.09.17', 'YYYY.MM.DD'))
from dual;

-- 256